# FlowTune Backend - å®Œæ•´åŠŸèƒ½ç‰ˆæœ¬

FlowTune Backend ç°å·²å®Œæˆä» `packages/nodejs` çš„ FlowGram Runtime é€»è¾‘è¿ç§»ï¼Œå¹¶å®ç°äº†å®Œæ•´çš„ç”Ÿäº§çº§åŠŸèƒ½ã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### åŸæœ‰åŠŸèƒ½
- âœ… åº”ç”¨ç®¡ç† (App Management)
- âœ… é‰´æƒç®¡ç† (Authentication)
- âœ… æ“ä½œæ‰§è¡Œ (Action Execution)
- âœ… æµç¨‹å¼•æ“ (Flow Engine)
- âœ… å¼€æ”¾å¹³å°é›†æˆ (Platform Integration)

### æ–°å¢åŠŸèƒ½ (ä» nodejs åŒ…è¿ç§»)
- âœ… FlowGram Runtime APIs
- âœ… OpenAPI æ–‡æ¡£ç”Ÿæˆ
- âœ… æœåŠ¡å™¨ä¿¡æ¯ç«¯ç‚¹

### ç”Ÿäº§çº§ä¼˜åŒ–åŠŸèƒ½
- âœ… **å®Œæ•´çš„ WebSocket æ”¯æŒ** - å®æ—¶é€šä¿¡ï¼Œå®¢æˆ·ç«¯ç®¡ç†ï¼Œä¸»é¢˜è®¢é˜…
- âœ… **Swagger UI é›†æˆ** - äº¤äº’å¼ API æ–‡æ¡£
- âœ… **è¯¦ç»†é”™è¯¯å¤„ç†** - ç»Ÿä¸€é”™è¯¯æ ¼å¼ï¼Œè¯·æ±‚è¿½è¸ª
- âœ… **API é€Ÿç‡é™åˆ¶** - å¤šå±‚çº§é™æµç­–ç•¥
- âœ… **æ—¥å¿—è®°å½•å¢å¼º** - ç»“æ„åŒ–æ—¥å¿—ï¼Œæ€§èƒ½ç›‘æ§
- âœ… **æµ‹è¯•è¦†ç›–** - Jest æµ‹è¯•æ¡†æ¶

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚   Backend       â”‚    â”‚   WebSocket     â”‚
â”‚   (React)       â”‚â—„â”€â”€â–ºâ”‚   (Hono)        â”‚â—„â”€â”€â–ºâ”‚   Server        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Database      â”‚
                        â”‚   (SQLite)      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ è¿è¡Œè¯´æ˜

### å®‰è£…ä¾èµ–
```bash
cd packages/backend
npm install
```

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```

### ç”Ÿäº§æ¨¡å¼
```bash
npm run build
npm start
```

### æµ‹è¯•
```bash
npm test
npm run test:coverage
```

## ğŸŒ æœåŠ¡ç«¯ç‚¹

| æœåŠ¡ | ç«¯å£ | æè¿° |
|------|------|------|
| HTTP API | 4000 | ä¸»è¦ API æœåŠ¡ |
| WebSocket | 8080 | å®æ—¶é€šä¿¡ |

## ğŸ“š API æ–‡æ¡£

- **Swagger UI**: http://localhost:4000/docs
- **ç®€åŒ–æ–‡æ¡£**: http://localhost:4000/simple  
- **OpenAPI è§„èŒƒ**: http://localhost:4000/openapi.json

## ğŸ” ç›‘æ§ç«¯ç‚¹

- **å¥åº·æ£€æŸ¥**: http://localhost:4000/
- **API å¥åº·**: http://localhost:4000/api/health
- **ç³»ç»Ÿæ—¥å¿—**: http://localhost:4000/system/logs/stats
- **é€Ÿç‡é™åˆ¶**: http://localhost:4000/system/rate-limit/status
- **WebSocket çŠ¶æ€**: http://localhost:4000/ws/stats

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
```bash
# æœåŠ¡å™¨é…ç½®
NODE_ENV=development
PORT=4000

# æ•°æ®åº“é…ç½®  
DATABASE_URL=./data/flowtune.db

# FlowGram Runtime
FLOWGRAM_API_KEY=your_api_key
FLOWGRAM_SECRET=your_secret

# CORS é…ç½®
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# æ—¥å¿—çº§åˆ«
LOG_LEVEL=info
```

### é€Ÿç‡é™åˆ¶ç­–ç•¥
- **ä¸€èˆ¬ API**: 100 è¯·æ±‚ / 15 åˆ†é’Ÿ
- **FlowGram API**: 50 è¯·æ±‚ / 10 åˆ†é’Ÿ  
- **æ•æ„Ÿæ“ä½œ**: 10 è¯·æ±‚ / 5 åˆ†é’Ÿ
- **WebSocket**: 30 è¯·æ±‚ / åˆ†é’Ÿ

## ğŸ”Œ WebSocket ä½¿ç”¨

è¿æ¥åˆ° `ws://localhost:8080`

### æ¶ˆæ¯æ ¼å¼
```javascript
// Ping
{ "type": "ping" }

// è®¢é˜…ä¸»é¢˜
{ "type": "subscribe", "topic": "flow-updates" }

// æ‰§è¡Œæµç¨‹
{ "type": "flow-execute", "data": { "flowId": "123" } }
```

## ğŸ§ª æµ‹è¯•è¯´æ˜

### è¿è¡Œæµ‹è¯•
```bash
npm test                # è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:watch      # ç›‘å¬æ¨¡å¼
npm run test:coverage   # ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
```

## ğŸ“ˆ æ€§èƒ½ç‰¹æ€§

- **è¯·æ±‚æ—¥å¿—è®°å½•** - åŒ…å«å“åº”æ—¶é—´å’ŒçŠ¶æ€ç 
- **å†…å­˜æ—¥å¿—å­˜å‚¨** - æœ€è¿‘ 1000 æ¡æ—¥å¿—
- **è‡ªåŠ¨æ¸…ç†** - è¿‡æœŸé€Ÿç‡é™åˆ¶è®°å½•è‡ªåŠ¨æ¸…ç†
- **WebSocket å¿ƒè·³** - 30 ç§’è¶…æ—¶è‡ªåŠ¨æ–­å¼€

## ğŸš§ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–
- [ ] Redis ç¼“å­˜é›†æˆ
- [ ] é›†ç¾¤éƒ¨ç½²æ”¯æŒ
- [ ] Prometheus æŒ‡æ ‡é›†æˆ
- [ ] Docker å®¹å™¨åŒ–
- [ ] CI/CD æµæ°´çº¿
